#{"solver": {"engine": {"type": "ExactEngine"}, "semiring": "GraphSemiring"}, "networks": [{"name": "perc_net_version_5_NeSy_danger_pedestrian", "module": "AD_V5_NeSy_0_net_danger_pedestrian(\n  (image_features): Sequential(\n    (0): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))\n    (1): ReLU()\n    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (3): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))\n    (4): ReLU()\n    (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (6): Flatten(start_dim=0, end_dim=2)\n    (7): Linear(in_features=2704, out_features=800, bias=True)\n    (8): ReLU()\n    (9): Linear(in_features=800, out_features=120, bias=True)\n    (10): ReLU()\n    (11): Linear(in_features=120, out_features=16, bias=True)\n    (12): ReLU()\n  )\n  (numeric_features): Sequential(\n    (0): Linear(in_features=1, out_features=9, bias=True)\n    (1): ReLU()\n    (2): Linear(in_features=9, out_features=9, bias=True)\n    (3): ReLU()\n  )\n  (combined_features): Sequential(\n    (0): Linear(in_features=25, out_features=16, bias=True)\n    (1): ReLU()\n    (2): Linear(in_features=16, out_features=4, bias=True)\n    (3): Softmax(dim=-1)\n  )\n)", "optimizer": "Adam (\nParameter Group 0\n    amsgrad: False\n    betas: (0.9, 0.999)\n    capturable: False\n    differentiable: False\n    eps: 1e-08\n    foreach: None\n    fused: None\n    lr: 0.0001\n    maximize: False\n    weight_decay: 0\n)", "k": null}, {"name": "perc_net_version_5_NeSy_speed_zone", "module": "AD_V5_NeSy_0_net_speed_zone(\n  (softmax): Softmax(dim=1)\n  (encoder): Sequential(\n    (0): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))\n    (1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (2): ReLU(inplace=True)\n    (3): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))\n    (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (5): ReLU(inplace=True)\n  )\n  (classifier): Sequential(\n    (0): Linear(in_features=256, out_features=120, bias=True)\n    (1): ReLU()\n    (2): Linear(in_features=120, out_features=84, bias=True)\n    (3): ReLU()\n    (4): Linear(in_features=84, out_features=10, bias=True)\n  )\n)", "optimizer": "Adam (\nParameter Group 0\n    amsgrad: False\n    betas: (0.9, 0.999)\n    capturable: False\n    differentiable: False\n    eps: 1e-08\n    foreach: None\n    fused: None\n    lr: 0.0001\n    maximize: False\n    weight_decay: 0\n)", "k": null}, {"name": "perc_net_version_5_NeSy_traffic_light", "module": "AD_V5_NeSy_0_net_traffic_light(\n  (softmax): Softmax(dim=1)\n  (encoder): Sequential(\n    (0): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))\n    (1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (2): ReLU(inplace=True)\n    (3): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))\n    (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (5): ReLU(inplace=True)\n  )\n  (classifier): Sequential(\n    (0): Linear(in_features=2704, out_features=800, bias=True)\n    (1): ReLU()\n    (2): Linear(in_features=800, out_features=80, bias=True)\n    (3): ReLU()\n    (4): Linear(in_features=80, out_features=3, bias=True)\n  )\n)", "optimizer": "Adam (\nParameter Group 0\n    amsgrad: False\n    betas: (0.9, 0.999)\n    capturable: False\n    differentiable: False\n    eps: 1e-08\n    foreach: None\n    fused: None\n    lr: 0.0001\n    maximize: False\n    weight_decay: 0\n)", "k": null}, {"name": "perc_net_version_5_NeSy_intersection", "module": "AD_V5_NeSy_0_net_danger_intersection(\n  (image_features): Sequential(\n    (0): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))\n    (1): ReLU()\n    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (3): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))\n    (4): ReLU()\n    (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (6): Flatten(start_dim=0, end_dim=2)\n    (7): Linear(in_features=2704, out_features=800, bias=True)\n    (8): ReLU()\n    (9): Linear(in_features=800, out_features=120, bias=True)\n    (10): ReLU()\n    (11): Linear(in_features=120, out_features=16, bias=True)\n    (12): ReLU()\n  )\n  (combined_features): Sequential(\n    (0): Linear(in_features=17, out_features=8, bias=True)\n    (1): ReLU()\n    (2): Linear(in_features=8, out_features=2, bias=True)\n    (3): Softmax(dim=-1)\n  )\n)", "optimizer": "Adam (\nParameter Group 0\n    amsgrad: False\n    betas: (0.9, 0.999)\n    capturable: False\n    differentiable: False\n    eps: 1e-08\n    foreach: None\n    fused: None\n    lr: 0.0001\n    maximize: False\n    weight_decay: 0\n)", "k": null}, {"name": "perc_net_version_5_NeSy_traffic_sign", "module": "AD_V5_NeSy_0_net_traffic_sign(\n  (softmax): Softmax(dim=1)\n  (encoder): Sequential(\n    (0): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))\n    (1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (2): ReLU(inplace=True)\n    (3): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))\n    (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (5): ReLU(inplace=True)\n  )\n  (classifier): Sequential(\n    (0): Linear(in_features=2704, out_features=800, bias=True)\n    (1): ReLU()\n    (2): Linear(in_features=800, out_features=80, bias=True)\n    (3): ReLU()\n    (4): Linear(in_features=80, out_features=3, bias=True)\n  )\n)", "optimizer": "Adam (\nParameter Group 0\n    amsgrad: False\n    betas: (0.9, 0.999)\n    capturable: False\n    differentiable: False\n    eps: 1e-08\n    foreach: None\n    fused: None\n    lr: 0.0001\n    maximize: False\n    weight_decay: 0\n)", "k": null}], "program": "nn(perc_net_version_5_NeSy_danger_pedestrian,[Img, Speed],X,[0, 1, 2, 3])::cell_danger_pedestrian(Img,Speed,X).\nnn(perc_net_version_5_NeSy_speed_zone,[MNIST],SZ,[0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0])::cell_speed_zone(MNIST,SZ).\nnn(perc_net_version_5_NeSy_traffic_light,[Img],X,[green, orange, red])::cell_traffic_light(Img,X).\nnn(perc_net_version_5_NeSy_intersection,[Img, P],X,[nothing, danger])::cell_danger_intersection(Img,P,X).\nnn(perc_net_version_5_NeSy_traffic_sign,[Img],X,[priority_right, priority_all, priority_intersection])::cell_traffic_sign(Img,X).\nspeed_zone_brake(MNIST,Speed) :- cell_speed_zone(MNIST,SZ), Speed>SZ.\nspeed_zone_follow(MNIST,Speed) :- cell_speed_zone(MNIST,SZ), Sl is SZ-0.11, Speed=<SZ, Speed>Sl.\nspeed_zone_accelerate(MNIST,Speed) :- cell_speed_zone(MNIST,SZ), Sl is SZ-0.11, Speed=<Sl.\nbrake_dist(Y,Speed) :- Acc=0.1, Frames_brake=Speed/(2*Acc), Y is -(2*Acc)*Frames_brake**2/2+Speed*Frames_brake.\nidle_dist(Y,Speed) :- Acc=0.1, Frames_idle=Speed/(Acc/2), Y is -(Acc/2)*Frames_idle**2/2+Speed*Frames_idle.\ntraffic_light_brake(Img,MNIST,Speed,Tl_y,P_y) :- \\+Tl_y=-1, \\+traffic_sign_valid(Img), Margin=85, Yr is P_y-Tl_y, Yr>=0, brake_dist(Yb,Speed), Yb_margin is Yb+Margin, Yr<Yb_margin, Mb is Margin-1, (Speed>0.2; Yr<Mb), cell_traffic_light(Img,C), C=red.\ntraffic_light_idle(Img,MNIST,Speed,Tl_y,P_y) :- \\+Tl_y=-1, \\+traffic_sign_valid(Img), Margin=85, Yr is P_y-Tl_y, Yr>=0, Yr<300, brake_dist(Yb,Speed), Yb_margin is Yb+Margin, Yr<Yb_margin, Mb is Margin-1, (Speed=<0.2; Yr>=Mb), cell_traffic_light(Img,C), C=red.\ntraffic_light_accelerate(Img,MNIST,Speed,Tl_y,P_y) :- \\+Tl_y=-1, \\+traffic_sign_valid(Img), Yr is P_y-Tl_y+85, (Yr<0; Yr<300, brake_dist(Yb,Speed), idle_dist(Yi,Speed), Yr>=Yb, Yr>=Yi; cell_traffic_light(Img,C), C=green).\nintersection_region(left,P) :- P=0.0.\nintersection_region(right,P) :- P=1.0.\nintersection_brake(Img,Speed,Player_y,Intersection_y) :- Margin=20, Yr is Player_y-Intersection_y, Yr>=0, Yr=<300, brake_dist(Yb,Speed), Yb_margin is Yb+Margin, Yr<Yb_margin, Mb is Margin-1, (Speed>0.2; Yr<Mb), (traffic_sign_priority_right_brake(Img); traffic_sign_priority_all_brake(Img)).\nintersection_idle(Img,Speed,Player_y,Intersection_y) :- Margin=20, Yr is Player_y-Intersection_y, Yr>=0, Yr=<300, (brake_dist(Yb,Speed), Yb_margin is Yb+Margin, Yr<Yb_margin, Mb is Margin-1, (Speed=<0.2; Yr>=Mb), (traffic_sign_priority_right_brake(Img); traffic_sign_priority_all_brake(Img)); idle_dist(Yi,Speed), Yi_margin is Yi+Margin, Yr<Yi_margin, (traffic_sign_priority_right_brake(Img); traffic_sign_priority_all_brake(Img))).\nintersection_accelerate(Img,Speed,Player_y,Intersection_y) :- Yr is Player_y-Intersection_y, (Yr>=0, Yr=<300, brake_dist(Yb,Speed), idle_dist(Yi,Speed), Yr>=Yb, Yr>=Yi; traffic_sign_priority_intersection(Img); traffic_sign_priority_right_accelerate(Img); traffic_sign_priority_all_accelerate(Img)).\ntraffic_sign_valid(Img) :- cell_traffic_light(Img,C), C=orange.\ntraffic_sign_priority_right_brake(Img) :- traffic_sign_valid(Img), intersection_region(right,Pr), cell_traffic_sign(Img,priority_right), cell_danger_intersection(Img,Pr,danger).\ntraffic_sign_priority_right_accelerate(Img) :- traffic_sign_valid(Img), intersection_region(right,Pr), cell_traffic_sign(Img,priority_right), cell_danger_intersection(Img,Pr,nothing).\ntraffic_sign_priority_all_brake(Img) :- traffic_sign_valid(Img), intersection_region(left,Pl), intersection_region(right,Pr), cell_traffic_sign(Img,priority_all), (cell_danger_intersection(Img,Pl,danger); cell_danger_intersection(Img,Pr,danger)).\ntraffic_sign_priority_all_accelerate(Img) :- traffic_sign_valid(Img), intersection_region(left,Pl), intersection_region(right,Pr), cell_traffic_sign(Img,priority_all), cell_danger_intersection(Img,Pl,nothing), cell_danger_intersection(Img,Pr,nothing).\ntraffic_sign_priority_intersection(Img) :- traffic_sign_valid(Img), cell_traffic_sign(Img,priority_intersection).\naction(Img,MNIST,Speed,Player_y,Intersection_y,Tl_y,1) :- speed_zone_brake(MNIST,Speed); traffic_light_brake(Img,MNIST,Speed,Tl_y,Player_y); intersection_brake(Img,Speed,Player_y,Intersection_y); cell_danger_pedestrian(Img,Speed,3).\naction(Img,MNIST,Speed,Player_y,Intersection_y,Tl_y,2) :- (traffic_light_idle(Img,MNIST,Speed,Tl_y,Player_y); intersection_idle(Img,Speed,Player_y,Intersection_y); cell_danger_pedestrian(Img,Speed,2)), \\+action(Img,MNIST,Speed,Player_y,Intersection_y,Tl_y,1).\naction(Img,MNIST,Speed,Player_y,Intersection_y,Tl_y,3) :- (speed_zone_follow(MNIST,Speed); cell_danger_pedestrian(Img,Speed,1)), \\+action(Img,MNIST,Speed,Player_y,Intersection_y,Tl_y,1), \\+action(Img,MNIST,Speed,Player_y,Intersection_y,Tl_y,2).\naction(Img,MNIST,Speed,Player_y,Intersection_y,Tl_y,0) :- (traffic_light_accelerate(Img,MNIST,Speed,Tl_y,Player_y); intersection_accelerate(Img,Speed,Player_y,Intersection_y); cell_danger_pedestrian(Img,Speed,0)), \\+action(Img,MNIST,Speed,Player_y,Intersection_y,Tl_y,1), \\+action(Img,MNIST,Speed,Player_y,Intersection_y,Tl_y,2), \\+action(Img,MNIST,Speed,Player_y,Intersection_y,Tl_y,3).\n"}
#Accuracy 0.4216589861751152
i,time,loss,ground_time,compile_time,eval_time
2,0.029239892959594727,31.821081161499023,0.005053997039794922,0.003664255142211914,0.002454042434692383
3,0.07707786560058594,0.1084711104631424,0.008948802947998047,0.003373861312866211,0.007133007049560547
4,0.10959291458129883,11.236098289489746,0.007589817047119141,0.0022389888763427734,0.003950834274291992
#{"solver": {"engine": {"type": "ExactEngine"}, "semiring": "GraphSemiring"}, "networks": [{"name": "perc_net_version_3_NeSy_danger_pedestrian", "module": "AD_V3_NeSy_2_net_danger_pedestrian(\n  (image_features): Sequential(\n    (0): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))\n    (1): ReLU()\n    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (3): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))\n    (4): ReLU()\n    (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (6): Flatten(start_dim=0, end_dim=2)\n    (7): Linear(in_features=2704, out_features=800, bias=True)\n    (8): ReLU()\n    (9): Linear(in_features=800, out_features=120, bias=True)\n    (10): ReLU()\n    (11): Linear(in_features=120, out_features=16, bias=True)\n    (12): ReLU()\n  )\n  (numeric_features): Sequential(\n    (0): Linear(in_features=1, out_features=9, bias=True)\n    (1): ReLU()\n    (2): Linear(in_features=9, out_features=9, bias=True)\n    (3): ReLU()\n  )\n  (combined_features): Sequential(\n    (0): Linear(in_features=25, out_features=16, bias=True)\n    (1): ReLU()\n    (2): Linear(in_features=16, out_features=4, bias=True)\n    (3): Softmax(dim=-1)\n  )\n)", "optimizer": "Adam (\nParameter Group 0\n    amsgrad: False\n    betas: (0.9, 0.999)\n    capturable: False\n    differentiable: False\n    eps: 1e-08\n    foreach: None\n    fused: None\n    lr: 0.0001\n    maximize: False\n    weight_decay: 0\n)", "k": null}, {"name": "perc_net_version_3_NeSy_speed_zone", "module": "AD_V3_NeSy_2_net_speed_zone(\n  (softmax): Softmax(dim=1)\n  (encoder): Sequential(\n    (0): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))\n    (1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (2): ReLU(inplace=True)\n    (3): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))\n    (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (5): ReLU(inplace=True)\n  )\n  (classifier): Sequential(\n    (0): Linear(in_features=256, out_features=120, bias=True)\n    (1): ReLU()\n    (2): Linear(in_features=120, out_features=84, bias=True)\n    (3): ReLU()\n    (4): Linear(in_features=84, out_features=10, bias=True)\n  )\n)", "optimizer": "Adam (\nParameter Group 0\n    amsgrad: False\n    betas: (0.9, 0.999)\n    capturable: False\n    differentiable: False\n    eps: 1e-08\n    foreach: None\n    fused: None\n    lr: 0.0001\n    maximize: False\n    weight_decay: 0\n)", "k": null}, {"name": "perc_net_version_3_NeSy_traffic_light", "module": "AD_V3_NeSy_2_net_traffic_light(\n  (softmax): Softmax(dim=1)\n  (encoder): Sequential(\n    (0): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))\n    (1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (2): ReLU(inplace=True)\n    (3): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))\n    (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n    (5): ReLU(inplace=True)\n  )\n  (classifier): Sequential(\n    (0): Linear(in_features=2704, out_features=800, bias=True)\n    (1): ReLU()\n    (2): Linear(in_features=800, out_features=80, bias=True)\n    (3): ReLU()\n    (4): Linear(in_features=80, out_features=3, bias=True)\n  )\n)", "optimizer": "Adam (\nParameter Group 0\n    amsgrad: False\n    betas: (0.9, 0.999)\n    capturable: False\n    differentiable: False\n    eps: 1e-08\n    foreach: None\n    fused: None\n    lr: 0.0001\n    maximize: False\n    weight_decay: 0\n)", "k": null}], "program": "nn(perc_net_version_3_NeSy_danger_pedestrian,[Img, Speed],X,[0, 1, 2, 3])::cell_danger_pedestrian(Img,Speed,X).\nnn(perc_net_version_3_NeSy_speed_zone,[MNIST],SZ,[0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0])::cell_speed_zone(MNIST,SZ).\nnn(perc_net_version_3_NeSy_traffic_light,[Img],X,[green, orange, red])::cell_traffic_light(Img,X).\nped_brake(Img,Speed) :- cell_danger_pedestrian(Img,Speed,D), D=3.\nped_idle(Img,Speed) :- cell_danger_pedestrian(Img,Speed,D), D=2.\nped_follow(Img,Speed) :- cell_danger_pedestrian(Img,Speed,D), D=1.\nped_acc(Img,Speed) :- cell_danger_pedestrian(Img,Speed,D), D=0.\nspeed_zone_brake(MNIST,Speed) :- cell_speed_zone(MNIST,SZ), Speed>SZ.\nspeed_zone_follow(MNIST,Speed) :- cell_speed_zone(MNIST,SZ), Sl is SZ-0.11, Speed=<SZ, Speed>Sl.\nspeed_zone_accelerate(MNIST,Speed) :- cell_speed_zone(MNIST,SZ), Sl is SZ-0.11, Speed=<Sl.\nbrake_dist(Y,Speed) :- Acc=0.1, Frames_brake=Speed/(2*Acc), Y is -(2*Acc)*Frames_brake**2/2+Speed*Frames_brake.\nidle_dist(Y,Speed) :- Acc=0.1, Frames_idle=Speed/(Acc/2), Y is -(Acc/2)*Frames_idle**2/2+Speed*Frames_idle.\ntraffic_light_brake(Img,MNIST,Speed,Tl_y,P_y) :- \\+Tl_y=-1, Margin=15, Yr is P_y-Tl_y, Yr>=0, brake_dist(Yb,Speed), Yb_margin is Yb+Margin, Yr<Yb_margin, Mb is Margin-1, (Speed>0.2; Yr<Mb), cell_traffic_light(Img,C), (C=red; C=orange).\ntraffic_light_idle(Img,MNIST,Speed,Tl_y,P_y) :- \\+Tl_y=-1, Margin=15, Yr is P_y-Tl_y, Yr>=0, Yr<300, (brake_dist(Yb,Speed), Yb_margin is Yb+Margin, Yr<Yb_margin, Mb is Margin-1, (Speed=<0.2; Yr>=Mb), cell_traffic_light(Img,C), (C=red; C=orange); idle_dist(Yi,Speed), Yi_margin is Yi+Margin, Yr<Yi_margin, cell_traffic_light(Img,C), C=orange).\ntraffic_light_accelerate(Img,MNIST,Speed,Tl_y,P_y) :- Tl_y=-1; Yr is P_y-Tl_y, (Yr<0; Yr<300, brake_dist(Yb,Speed), idle_dist(Yi,Speed), Yr>=Yb, Yr>=Yi; cell_traffic_light(Img,C), C=green).\naction(Img,MNIST,Speed,Tl_y,P_y,1) :- speed_zone_brake(MNIST,Speed); traffic_light_brake(Img,MNIST,Speed,Tl_y,P_y); ped_brake(Img,Speed).\naction(Img,MNIST,Speed,Tl_y,P_y,2) :- (traffic_light_idle(Img,MNIST,Speed,Tl_y,P_y); ped_idle(Img,Speed)), \\+action(Img,MNIST,Speed,Tl_y,P_y,1).\naction(Img,MNIST,Speed,Tl_y,P_y,3) :- (speed_zone_follow(MNIST,Speed); ped_follow(Img,Speed)), \\+action(Img,MNIST,Speed,Tl_y,P_y,1), \\+action(Img,MNIST,Speed,Tl_y,P_y,2).\naction(Img,MNIST,Speed,Tl_y,P_y,0) :- (traffic_light_accelerate(Img,MNIST,Speed,Tl_y,P_y); ped_acc(Img,Speed)), \\+action(Img,MNIST,Speed,Tl_y,P_y,1), \\+action(Img,MNIST,Speed,Tl_y,P_y,2), \\+action(Img,MNIST,Speed,Tl_y,P_y,3).\n"}
#Accuracy 0.7954545454545454
i,time,loss,ground_time,compile_time,eval_time
10,0.7141430377960205,3.9874969141689918,0.005577164888381958,0.0017971396446228027,0.00286940336227417
20,1.3655872344970703,4.510155578228355,0.004667192697525024,0.0018826663494110108,0.0031969726085662844
30,1.9568791389465332,2.9617359213298697,0.004607194662094116,0.001956731081008911,0.0031106054782867433
40,2.6774940490722656,2.2172461787013846,0.00528382658958435,0.002240175008773804,0.0036156237125396728
50,3.410388231277466,3.197170711797901,0.006714785099029541,0.0021915078163146974,0.0036378979682922365
60,4.081735134124756,4.549726437267964,0.005153232812881469,0.0019421875476837158,0.003415811061859131
70,4.768292188644409,3.465266349524609,0.0053643882274627686,0.0018357038497924805,0.003581857681274414
80,5.418085098266602,3.061962769193542,0.00510779619216919,0.0019174695014953613,0.0035578668117523192
90,6.074437141418457,3.89601992044486,0.005151140689849854,0.0019609272480010987,0.003526431322097778
100,6.687978982925415,2.0468943467031755,0.00487862229347229,0.001828169822692871,0.0033283591270446776
110,7.38292121887207,1.687279009831056,0.006822949647903443,0.0017849206924438477,0.0034918427467346192
120,8.043452262878418,2.0554497128819604,0.005088204145431518,0.0019450783729553223,0.0034976124763488768
130,8.650827169418335,2.5068027554271,0.004543483257293701,0.0020018577575683593,0.003242456912994385
140,9.320679187774658,2.013949983575375,0.0053583323955535885,0.0021837890148162843,0.003670114278793335
150,9.922368049621582,1.9060230976625463,0.004881519079208374,0.0020162999629974366,0.0032635927200317383
160,10.589298248291016,2.1343546491183587,0.00517275333404541,0.0019461870193481444,0.0034442245960235596
170,11.267212152481079,1.484420606114469,0.005188977718353272,0.0018749833106994629,0.0034330546855926513
180,11.978669166564941,1.652454581727034,0.004686468839645385,0.0018445730209350586,0.005695247650146484
190,12.58512830734253,1.301078131734471,0.006351556380589804,0.0020222167174021406,0.0035787542661031083
200,13.011243104934692,1.2098886399192907,0.004912179708480835,0.001978820562362671,0.0033264219760894775
210,13.413477182388306,1.5599314014369157,0.004561948776245117,0.001899886131286621,0.0030882418155670165
220,13.874775171279907,1.3156869632774033,0.004919809103012085,0.002110159397125244,0.0035017311573028566
230,14.34648323059082,1.3005975683568978,0.006856793165206909,0.002198457717895508,0.003577780723571777
240,14.780493021011353,1.2373720456700539,0.005106103420257568,0.0020665764808654786,0.0034426569938659666
250,15.251261234283447,1.181416942202486,0.005465048551559448,0.0019408822059631347,0.00367811918258667
260,15.699835300445557,0.8307057263562456,0.005318641662597656,0.0018888235092163086,0.003482764959335327
270,16.148072242736816,1.0873341943704873,0.004928582906723022,0.0019515037536621093,0.003533744812011719
280,16.592995166778564,0.9873387434464803,0.004902857542037964,0.0018407464027404784,0.003418916463851929
290,17.072989225387573,0.6687962495670945,0.006879794597625733,0.0018457889556884766,0.00365065336227417
300,17.510415077209473,1.1512861146693467,0.004997819662094116,0.0017424523830413818,0.0033471286296844482
310,17.959105014801025,0.8967786747765786,0.004902839660644531,0.002074229717254639,0.0034506738185882567
320,18.39995527267456,1.476844224877641,0.00492439866065979,0.0021085143089294434,0.0033453941345214845
330,18.832632064819336,1.0611798126832581,0.005013161897659301,0.0018911480903625489,0.003291821479797363
340,19.27914524078369,0.9759763668087544,0.005136841535568237,0.0021526336669921873,0.0034092843532562258
350,19.71570920944214,0.867887852381682,0.005041331052780151,0.001936274766921997,0.003308725357055664
360,20.14127016067505,0.8979915543226525,0.005009984970092774,0.0017896533012390138,0.003312373161315918
370,20.60628032684326,0.9201132269692607,0.005274534225463867,0.0020374596118927003,0.003615325689315796
380,20.993773221969604,0.8501342157098406,0.006013240416844685,0.0019724170366923017,0.003103176752726237
390,21.40396523475647,1.0967934581567533,0.004667192697525024,0.0018826663494110108,0.0032202303409576416
400,21.787949085235596,0.8762151070637628,0.004607194662094116,0.001956731081008911,0.003106224536895752
410,22.23729920387268,1.2234142827306642,0.00528382658958435,0.002240175008773804,0.0034885048866271974
420,22.659961223602295,0.8590088092256337,0.006714785099029541,0.0021915078163146974,0.003453606367111206
430,23.076874017715454,1.0766443425789476,0.005153232812881469,0.0019421875476837158,0.0033813118934631348
440,23.496751070022583,0.63572987774387,0.0053643882274627686,0.0018357038497924805,0.0033928036689758303
450,23.9261691570282,0.9839526791998651,0.00510779619216919,0.0019174695014953613,0.0033954203128814696
460,24.334192276000977,0.8025426497843,0.005151140689849854,0.0019609272480010987,0.003372734785079956
470,24.730751991271973,0.49976450946560363,0.00487862229347229,0.001828169822692871,0.0031954050064086914
480,25.145186185836792,0.566894018813764,0.006822949647903443,0.0017849206924438477,0.003327363729476929
490,25.591087102890015,1.04209868199614,0.005088204145431518,0.0019450783729553223,0.0034564077854156495
500,25.997392177581787,1.3273866748873844,0.004543483257293701,0.0020018577575683593,0.0031488656997680662
510,26.462427139282227,0.8898344403407463,0.0053583323955535885,0.0021837890148162843,0.0036120057106018067
520,26.8792622089386,0.7938161100435537,0.004881519079208374,0.0020162999629974366,0.0032329320907592773
530,27.33917212486267,0.923731097340351,0.00517275333404541,0.0019461870193481444,0.003442811965942383
540,27.74153423309326,0.5984211045397387,0.005188977718353272,0.0018749833106994629,0.003199237585067749
550,28.13085412979126,0.8211017494206316,0.004686468839645385,0.0018445730209350586,0.003130984306335449
560,28.55206322669983,0.7268173712029238,0.006351556380589804,0.0020222167174021406,0.0033873716990152998
570,28.969118356704712,0.7724353369358141,0.004912179708480835,0.001978820562362671,0.00327606201171875
580,29.347445011138916,0.8598449423108832,0.004561948776245117,0.001899886131286621,0.00306738018989563
590,29.768859148025513,1.0227428228536155,0.004919809103012085,0.002110159397125244,0.0033585429191589355
600,30.215028285980225,0.8312605277635157,0.006856793165206909,0.002198457717895508,0.003512638807296753
610,30.625710248947144,0.8811745345126838,0.005106103420257568,0.0020665764808654786,0.0033651649951934814
620,31.07263207435608,0.7107807802967727,0.005465048551559448,0.0019408822059631347,0.003577554225921631
630,31.497445106506348,0.518697076663375,0.005318641662597656,0.0018888235092163086,0.0033763527870178224
640,31.911034107208252,0.7730040769063635,0.004928582906723022,0.0019515037536621093,0.0033898115158081054
650,32.300849199295044,0.6575525706968619,0.004902857542037964,0.0018407464027404784,0.0032428503036499023
660,32.71753430366516,0.4546811766049359,0.006879794597625733,0.0018457889556884766,0.0033186554908752443
670,33.120930194854736,0.7520994975202484,0.004997819662094116,0.0017424523830413818,0.003235197067260742
680,33.5412871837616,0.8377997940900969,0.004902839660644531,0.002074229717254639,0.0033682823181152345
690,33.94865107536316,1.1664308280757723,0.00492439866065979,0.0021085143089294434,0.003176850080490112
700,34.35461235046387,0.8056072148290696,0.005013161897659301,0.0018911480903625489,0.0032468616962432863
710,34.76932716369629,0.8133282123628305,0.005136841535568237,0.0021526336669921873,0.00326957106590271
720,35.19973397254944,0.5610658849356696,0.005041331052780151,0.001936274766921997,0.003298497200012207
730,35.61265516281128,0.7537501512793824,0.005009984970092774,0.0017896533012390138,0.0032377719879150392
740,36.06548810005188,0.6016968514188192,0.005274534225463867,0.0020374596118927003,0.0035716891288757324
750,36.459331035614014,0.6301086470590235,0.006013240416844685,0.0019724170366923017,0.0031648854414621985
760,36.868958950042725,0.9010447939188453,0.004667192697525024,0.0018826663494110108,0.0032286643981933594
770,37.256909132003784,0.6792080781488039,0.004607194662094116,0.001956731081008911,0.0031321406364440917
780,37.71500110626221,0.8256901358487084,0.00528382658958435,0.002240175008773804,0.0035329580307006834
790,38.140385150909424,0.683334534149617,0.006714785099029541,0.0021915078163146974,0.0035030901432037353
800,38.56426024436951,0.7214845540001988,0.005153232812881469,0.0019421875476837158,0.003438305854797363
810,38.99563694000244,0.4605526708997786,0.0053643882274627686,0.0018357038497924805,0.003437989950180054
820,39.434678077697754,0.7949864824746328,0.00510779619216919,0.0019174695014953613,0.0034263312816619875
830,39.856911182403564,0.5678339767026046,0.005151140689849854,0.0019609272480010987,0.0034401118755340576
840,40.262919187545776,0.3775533078500303,0.00487862229347229,0.001828169822692871,0.003248649835586548
850,40.67905402183533,0.3815499710013682,0.006822949647903443,0.0017849206924438477,0.0033462584018707276
860,41.10632920265198,0.7545675084642426,0.005088204145431518,0.0019450783729553223,0.003373885154724121
870,41.501652240753174,1.1069581371019013,0.004543483257293701,0.0020018577575683593,0.003091341257095337
880,41.943777084350586,0.6852143655696636,0.0053583323955535885,0.0021837890148162843,0.003462827205657959
890,42.33820700645447,0.6220136819058097,0.004881519079208374,0.0020162999629974366,0.003130096197128296
900,42.76702117919922,0.7629560612826026,0.00517275333404541,0.0019461870193481444,0.003352713584899902
910,43.17272710800171,0.5172887897742839,0.005188977718353272,0.0018749833106994629,0.0032164931297302248
920,43.56492614746094,0.6624705668742535,0.004686468839645385,0.0018445730209350586,0.003152233362197876